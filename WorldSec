    -- Services
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
-- World Variables
_G.World = _G.World or {}
_G.World.OriginalSettings = {}
_G.World.ColorCorrection = nil
_G.World.DepthOfField = nil
_G.World.Blur = nil
_G.World.SunRays = nil
_G.World.Bloom = nil
_G.World.StretchConnection = nil

-- Store original lighting settings
local function storeOriginalSettings()
    _G.World.OriginalSettings = {
        Brightness = Lighting.Brightness,
        Ambient = Lighting.Ambient,
        ColorShift_Bottom = Lighting.ColorShift_Bottom,
        ColorShift_Top = Lighting.ColorShift_Top,
        EnvironmentDiffuseScale = Lighting.EnvironmentDiffuseScale,
        EnvironmentSpecularScale = Lighting.EnvironmentSpecularScale,
        GlobalShadows = Lighting.GlobalShadows,
        OutdoorAmbient = Lighting.OutdoorAmbient,
        ShadowSoftness = Lighting.ShadowSoftness,
        ClockTime = Lighting.ClockTime,
        ExposureCompensation = Lighting.ExposureCompensation,
        FogStart = Lighting.FogStart,
        FogEnd = Lighting.FogEnd,
        FogColor = Lighting.FogColor
    }
end

-- Function to create/get ColorCorrection effect
local function getColorCorrection()
    if not _G.World.ColorCorrection then
        _G.World.ColorCorrection = Instance.new("ColorCorrectionEffect")
        _G.World.ColorCorrection.Parent = Lighting
        _G.World.ColorCorrection.Name = "CROW_ColorCorrection"
    end
    return _G.World.ColorCorrection
end

-- Function to create/get DepthOfField effect (FIXED)
local function getDepthOfField()
    if not _G.World.DepthOfField then
        _G.World.DepthOfField = Instance.new("DepthOfFieldEffect")
        _G.World.DepthOfField.Parent = Lighting
        _G.World.DepthOfField.Name = "CROW_DepthOfField"
        -- Set default values when creating
        _G.World.DepthOfField.FarIntensity = 0.75
        _G.World.DepthOfField.FocusDistance = 50
        _G.World.DepthOfField.InFocusRadius = 10
        _G.World.DepthOfField.NearIntensity = 0.75
        _G.World.DepthOfField.Enabled = false
    end
    return _G.World.DepthOfField
end

-- Function to create/get Blur effect
local function getBlur()
    if not _G.World.Blur then
        _G.World.Blur = Instance.new("BlurEffect")
        _G.World.Blur.Parent = Lighting
        _G.World.Blur.Name = "CROW_Blur"
    end
    return _G.World.Blur
end

-- Function to create/get SunRays effect
local function getSunRays()
    if not _G.World.SunRays then
        _G.World.SunRays = Instance.new("SunRaysEffect")
        _G.World.SunRays.Parent = Lighting
        _G.World.SunRays.Name = "CROW_SunRays"
    end
    return _G.World.SunRays
end

-- Function to create/get Bloom effect
local function getBloom()
    if not _G.World.Bloom then
        _G.World.Bloom = Instance.new("BloomEffect")
        _G.World.Bloom.Parent = Lighting
        _G.World.Bloom.Name = "CROW_Bloom"
    end
    return _G.World.Bloom
end

-- Function to restore original lighting
local function restoreOriginalLighting()
    for property, value in pairs(_G.World.OriginalSettings) do
        if Lighting[property] ~= nil then
            Lighting[property] = value
        end
    end
end

-- Function to apply horizontal stretch
local function applyHorizontalStretch(intensity)
    if _G.World.StretchConnection then
        _G.World.StretchConnection:Disconnect()
        _G.World.StretchConnection = nil
    end
    
    if intensity > 1 then
        _G.World.StretchConnection = RunService.Heartbeat:Connect(function()
            local camera = workspace.CurrentCamera
            if camera then
                -- Apply horizontal stretch by modifying CFrame
                local cf = camera.CFrame
                camera.CFrame = cf * CFrame.new(0, 0, 0, intensity, 0, 0, 0, 1, 0, 0, 0, 1)
            end
        end)
    end
end

-- Function to disable horizontal stretch
local function disableHorizontalStretch()
    if _G.World.StretchConnection then
        _G.World.StretchConnection:Disconnect()
        _G.World.StretchConnection = nil
    end
end

-- Initialize original settings
storeOriginalSettings()

-- UI Sections with improved safety checks
local LightingSection, ColorSection, VisualSection, UtilitySection

-- First, verify that _G.WorldTab exists
if not _G.WorldTab then
    _G.CROW:SendNotification("WorldTab not found! Make sure the main script is loaded first.", 5)
    return
end

-- Create sections with individual error handling
local function createSections()
    local success = true
    local errorMsg = ""
    
    -- Try to create each section individually
    local sectionSuccess, sectionError = pcall(function()
        LightingSection = _G.WorldTab:AddSection("Lighting Effects", 1)
    end)
    if not sectionSuccess then
        success = false
        errorMsg = errorMsg .. "LightingSection: " .. tostring(sectionError) .. " | "
    end
    
    sectionSuccess, sectionError = pcall(function()
        ColorSection = _G.WorldTab:AddSection("Color Effects", 1)
    end)
    if not sectionSuccess then
        success = false
        errorMsg = errorMsg .. "ColorSection: " .. tostring(sectionError) .. " | "
    end
    
    sectionSuccess, sectionError = pcall(function()
        UtilitySection = _G.WorldTab:AddSection("Utilities", 1)
    end)
    if not sectionSuccess then
        success = false
        errorMsg = errorMsg .. "UtilitySection: " .. tostring(sectionError) .. " | "
    end
    
    sectionSuccess, sectionError = pcall(function()
        VisualSection = _G.WorldTab:AddSection("Visual Effects", 2)
    end)
    if not sectionSuccess then
        success = false
        errorMsg = errorMsg .. "VisualSection: " .. tostring(sectionError) .. " | "
    end
    
    
    return success, errorMsg
end

local success, error = createSections()

if not success then
    _G.CROW:SendNotification("Failed to create World sections: " .. error, 5)
    return
end

-- Additional safety check - verify all sections were created
if not LightingSection then
    _G.CROW:SendNotification("LightingSection is nil!", 5)
    return
end

if not ColorSection then
    _G.CROW:SendNotification("ColorSection is nil!", 5)
    return
end

if not VisualSection then
    _G.CROW:SendNotification("VisualSection is nil!", 5)
    return
end

if not UtilitySection then
    _G.CROW:SendNotification("UtilitySection is nil!", 5)
    return
end

-- ===================== LIGHTING EFFECTS =====================
LightingSection:AddSeparator({ text = "Basic Lighting" })

LightingSection:AddToggle({
    text = "Full Bright",
    state = false,
    flag = "FullBright",
    tooltip = "Makes everything fully visible",
    callback = function(state)
        if state then
            Lighting.Brightness = 2
            Lighting.Ambient = Color3.new(1, 1, 1)
            Lighting.ColorShift_Bottom = Color3.new(1, 1, 1)
            Lighting.ColorShift_Top = Color3.new(1, 1, 1)
            Lighting.EnvironmentDiffuseScale = 1
            Lighting.EnvironmentSpecularScale = 1
            Lighting.GlobalShadows = false
            Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
            Lighting.ShadowSoftness = 0
        else
            restoreOriginalLighting()
        end
    end
})

LightingSection:AddToggle({
    text = "No Shadows",
    state = false,
    flag = "NoShadows",
    tooltip = "Removes all shadows",
    callback = function(state)
        Lighting.GlobalShadows = not state
    end
})

LightingSection:AddToggle({
    text = "No Fog",
    state = false,
    flag = "NoFog",
    tooltip = "Removes all fog effects",
    callback = function(state)
        if state then
            Lighting.FogStart = 0
            Lighting.FogEnd = math.huge
        else
            Lighting.FogStart = _G.World.OriginalSettings.FogStart
            Lighting.FogEnd = _G.World.OriginalSettings.FogEnd
        end
    end
})

LightingSection:AddSlider({
    enabled = true,
    text = "Brightness",
    tooltip = "Adjust world brightness",
    flag = "WorldBrightness",
    suffix = "",
    min = 0,
    max = 5,
    increment = 0.1,
    risky = false,
    callback = function(value)
        Lighting.Brightness = value
    end
})

LightingSection:AddSlider({
    enabled = true,
    text = "Exposure",
    tooltip = "Adjust exposure compensation",
    flag = "WorldExposure",
    suffix = "",
    min = -3,
    max = 3,
    increment = 0.1,
    risky = false,
    callback = function(value)
        Lighting.ExposureCompensation = value
    end
})

-- ===================== COLOR EFFECTS =====================
ColorSection:AddSeparator({ text = "Color Correction" })

ColorSection:AddToggle({
    text = "Enable Color Correction",
    state = false,
    flag = "ColorCorrectionEnabled",
    tooltip = "Enable color correction effects",
    callback = function(state)
        local cc = getColorCorrection()
        cc.Enabled = state
    end
})

ColorSection:AddSlider({
    enabled = true,
    text = "Brightness",
    tooltip = "Color correction brightness",
    flag = "CCBrightness",
    suffix = "",
    min = -1,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local cc = getColorCorrection()
        cc.Brightness = value
    end
})

ColorSection:AddSlider({
    enabled = true,
    text = "Contrast",
    tooltip = "Color correction contrast",
    flag = "CCContrast",
    suffix = "",
    min = -1,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local cc = getColorCorrection()
        cc.Contrast = value
    end
})

ColorSection:AddSlider({
    enabled = true,
    text = "Saturation",
    tooltip = "Color correction saturation",
    flag = "CCSaturation",
    suffix = "",
    min = -1,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local cc = getColorCorrection()
        cc.Saturation = value
    end
})

ColorSection:AddColor({
    enabled = true,
    text = "Tint Color",
    tooltip = "Apply color tint to the world",
    color = Color3.fromRGB(255, 255, 255),
    flag = "CCTintColor",
    trans = 0,
    open = false,
    risky = false,
    callback = function(color)
        local cc = getColorCorrection()
        cc.TintColor = color
    end
})

ColorSection:AddSeparator({ text = "Lighting Colors" })

ColorSection:AddColor({
    enabled = true,
    text = "Ambient Color",
    tooltip = "Change ambient lighting color",
    color = Color3.fromRGB(128, 128, 128),
    flag = "AmbientColor",
    trans = 0,
    open = false,
    risky = false,
    callback = function(color)
        Lighting.Ambient = color
    end
})

ColorSection:AddColor({
    enabled = true,
    text = "Fog Color",
    tooltip = "Change fog color",
    color = Color3.fromRGB(192, 192, 192),
    flag = "FogColor",
    trans = 0,
    open = false,
    risky = false,
    callback = function(color)
        Lighting.FogColor = color
    end
})

ColorSection:AddColor({
    enabled = true,
    text = "Outdoor Ambient",
    tooltip = "Change outdoor ambient color",
    color = Color3.fromRGB(128, 128, 128),
    flag = "OutdoorAmbientColor",
    trans = 0,
    open = false,
    risky = false,
    callback = function(color)
        Lighting.OutdoorAmbient = color
    end
})



-- =====================TIME OF DAY =====================
VisualSection:AddSeparator({ text = "Time of Day" })
VisualSection:AddSlider({
    enabled = true,
    text = "Time of Day",
    tooltip = "Change time of day",
    flag = "TimeOfDay",
    suffix = ":00",
    min = 0,
    max = 24,
    increment = 0.5,
    risky = false,
    callback = function(value)
        Lighting.ClockTime = value
    end
})
-- ===================== VISUAL EFFECTS =====================
VisualSection:AddSeparator({ text = "Screen Effects" })

VisualSection:AddToggle({
    text = "Blur Effect",
    state = false,
    flag = "BlurEnabled",
    tooltip = "Apply blur effect to screen",
    callback = function(state)
        local blur = getBlur()
        blur.Enabled = state
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Blur Size",
    tooltip = "Blur effect intensity",
    flag = "BlurSize",
    suffix = "",
    min = 0,
    max = 56,
    increment = 1,
    risky = false,
    callback = function(value)
        local blur = getBlur()
        blur.Size = value
    end
})

VisualSection:AddToggle({
    text = "Depth of Field",
    state = false,
    flag = "DepthOfFieldEnabled",
    tooltip = "Apply depth of field effect",
    callback = function(state)
        local dof = getDepthOfField()
        dof.Enabled = state
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Focus Distance",
    tooltip = "Depth of field focus distance",
    flag = "DOFFocusDistance",
    suffix = "",
    min = 0.1,
    max = 200,
    increment = 0.5,
    risky = false,
    callback = function(value)
        local dof = getDepthOfField()
        dof.FocusDistance = value
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "In Focus Radius",
    tooltip = "Depth of field in focus radius",
    flag = "DOFInFocusRadius",
    suffix = "",
    min = 1,
    max = 100,
    increment = 1,
    risky = false,
    callback = function(value)
        local dof = getDepthOfField()
        dof.InFocusRadius = value
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Far Intensity",
    tooltip = "Depth of field far blur intensity",
    flag = "DOFFarIntensity",
    suffix = "",
    min = 0,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local dof = getDepthOfField()
        dof.FarIntensity = value
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Near Intensity",
    tooltip = "Depth of field near blur intensity",
    flag = "DOFNearIntensity",
    suffix = "",
    min = 0,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local dof = getDepthOfField()
        dof.NearIntensity = value
    end
})

VisualSection:AddToggle({
    text = "Bloom Effect",
    state = false,
    flag = "BloomEnabled",
    tooltip = "Apply bloom glow effect",
    callback = function(state)
        local bloom = getBloom()
        bloom.Enabled = state
        if state then
            bloom.Intensity = 0.4
            bloom.Size = 24
            bloom.Threshold = 1.2
        end
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Bloom Intensity",
    tooltip = "Bloom effect intensity",
    flag = "BloomIntensity",
    suffix = "",
    min = 0,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local bloom = getBloom()
        bloom.Intensity = value
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Bloom Size",
    tooltip = "Bloom effect size",
    flag = "BloomSize",
    suffix = "",
    min = 1,
    max = 56,
    increment = 1,
    risky = false,
    callback = function(value)
        local bloom = getBloom()
        bloom.Size = value
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Bloom Threshold",
    tooltip = "Bloom effect threshold",
    flag = "BloomThreshold",
    suffix = "",
    min = 0,
    max = 2,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local bloom = getBloom()
        bloom.Threshold = value
    end
})

VisualSection:AddToggle({
    text = "Sun Rays",
    state = false,
    flag = "SunRaysEnabled",
    tooltip = "Apply sun rays effect",
    callback = function(state)
        local sunRays = getSunRays()
        sunRays.Enabled = state
        if state then
            sunRays.Intensity = 0.25
            sunRays.Spread = 1
        end
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Sun Rays Intensity",
    tooltip = "Sun rays effect intensity",
    flag = "SunRaysIntensity",
    suffix = "",
    min = 0,
    max = 1,
    increment = 0.01,
    risky = false,
    callback = function(value)
        local sunRays = getSunRays()
        sunRays.Intensity = value
    end
})

VisualSection:AddSlider({
    enabled = true,
    text = "Sun Rays Spread",
    tooltip = "Sun rays spread amount",
    flag = "SunRaysSpread",
    suffix = "",
    min = 0.1,
    max = 3,
    increment = 0.1,
    risky = false,
    callback = function(value)
        local sunRays = getSunRays()
        sunRays.Spread = value
    end
})




UtilitySection:AddSeparator({ text = "Utility Functions" })

local Lighting = game:GetService("Lighting")

local defaultSkybox = Lighting:FindFirstChildOfClass("Sky") and {
    SkyboxBk = Lighting:FindFirstChildOfClass("Sky").SkyboxBk,
    SkyboxDn = Lighting:FindFirstChildOfClass("Sky").SkyboxDn,
    SkyboxFt = Lighting:FindFirstChildOfClass("Sky").SkyboxFt,
    SkyboxLf = Lighting:FindFirstChildOfClass("Sky").SkyboxLf,
    SkyboxRt = Lighting:FindFirstChildOfClass("Sky").SkyboxRt,
    SkyboxUp = Lighting:FindFirstChildOfClass("Sky").SkyboxUp
}

local lastSkyboxData = nil
local customSkyboxEnabled = false

local skyboxes = {
    ["Red Storm"] = "159454299",
    ["Starry Night"] = "983765098",
    ["Sunny Sky"] = "121949310",
    ["Fog on the Water"] = {
        SkyboxBk = "15876597103",
        SkyboxDn = "15876592775",
        SkyboxFt = "15876640231",
        SkyboxLf = "15876638420",
        SkyboxRt = "15876595486",
        SkyboxUp = "15876639348"
    },
    ["Sunset"] = {
        SkyboxBk = "600830446",
        SkyboxDn = "600831635",
        SkyboxFt = "600832720",
        SkyboxLf = "600886090",
        SkyboxRt = "600833862",
        SkyboxUp = "600835177"
    }
}

local function notify(message, duration)
    if _G.CROW and _G.CROW.SendNotification then
        _G.CROW:SendNotification(message, duration or 4)
    else
        warn("[Skybox Script] " .. message)
    end
end

local function isValidAssetId(id)
    return id and id:match("^%d+$")
end

local function parseTextureIds(input)
    local ids = {}
    for id in input:gmatch("%d+") do
        table.insert(ids, id)
    end
    if #ids == 6 then
        return {
            SkyboxBk = ids[1],
            SkyboxDn = ids[2],
            SkyboxFt = ids[3],
            SkyboxLf = ids[4],
            SkyboxRt = ids[5],
            SkyboxUp = ids[6]
        }
    end
    return nil
end

local function applySkybox(skyboxData)
    local textures = skyboxData
    if type(skyboxData) == "string" then
        if not isValidAssetId(skyboxData) then
            notify("Invalid skybox ID: Must be numeric", 4)
            return
        end
        textures = {
            SkyboxBk = skyboxData,
            SkyboxDn = skyboxData,
            SkyboxFt = skyboxData,
            SkyboxLf = skyboxData,
            SkyboxRt = skyboxData,
            SkyboxUp = skyboxData
        }
    elseif type(skyboxData) ~= "table" then
        notify("Invalid skybox data: Must be string or table", 4)
        return
    end

    for face, id in pairs(textures) do
        if not isValidAssetId(id) then
            notify("Invalid texture ID for " .. face .. ": " .. tostring(id), 4)
            return
        end
    end

    for _, child in pairs(Lighting:GetChildren()) do
        if child:IsA("Sky") then
            child:Destroy()
        end
    end

    local success, err = pcall(function()
        local sky = Instance.new("Sky")
        sky.SkyboxBk = "rbxassetid://" .. textures.SkyboxBk
        sky.SkyboxDn = "rbxassetid://" .. textures.SkyboxDn
        sky.SkyboxFt = "rbxassetid://" .. textures.SkyboxFt
        sky.SkyboxLf = "rbxassetid://" .. textures.SkyboxLf
        sky.SkyboxRt = "rbxassetid://" .. textures.SkyboxRt
        sky.SkyboxUp = "rbxassetid://" .. textures.SkyboxUp
        sky.Parent = Lighting
    end)

    if not success then
        notify("Failed to apply skybox: " .. tostring(err), 6)
    end
end

local function restoreDefaultSkybox()
    for _, child in pairs(Lighting:GetChildren()) do
        if child:IsA("Sky") then
            child:Destroy()
        end
    end
    if defaultSkybox then
        local success, err = pcall(function()
            local sky = Instance.new("Sky")
            sky.SkyboxBk = defaultSkybox.SkyboxBk
            sky.SkyboxDn = defaultSkybox.SkyboxDn
            sky.SkyboxFt = defaultSkybox.SkyboxFt
            sky.SkyboxLf = defaultSkybox.SkyboxLf
            sky.SkyboxRt = defaultSkybox.SkyboxRt
            sky.SkyboxUp = defaultSkybox.SkyboxUp
            sky.Parent = Lighting
        end)
        if success then
            notify("Default skybox restored!", 4)
        else
            notify("Failed to restore default skybox: " .. tostring(err), 6)
        end
    else
        notify("No default skybox found!", 4)
    end
end

UtilitySection:AddList({
    enabled = true,
    text = "Skybox Selector",
    tooltip = "Choose a predefined skybox",
    selected = "",
    multi = false,
    open = false,
    max = 5,
    values = { "Red Storm", "Starry Night", "Sunny Sky", "Fog on the Water", "Sunset" },
    risky = false,
    callback = function(v)
        local skyboxData = skyboxes[v]
        if skyboxData then
            lastSkyboxData = skyboxData
            if customSkyboxEnabled then
                applySkybox(lastSkyboxData)
            end
        else
            notify("No skybox data found for selection: " .. v, 4)
        end
    end
})

UtilitySection:AddBox({
    enabled = true,
    text = "Custom Skybox ID(s)",
    name = "SkyBoxTextBox",
    flag = "SkyBoxTextBox_1",
    focused = false,
    risky = false,
    callback = function(v)
        if v and v ~= "" then
            local textureIds = parseTextureIds(v)
            if textureIds then
                lastSkyboxData = textureIds
            else
                local id = v:match("(%d+)$") or v
                if isValidAssetId(id) then
                    lastSkyboxData = id
                else
                    notify("Invalid input: Enter one ID or six comma-separated IDs", 4)
                    return
                end
            end
            if customSkyboxEnabled then
                applySkybox(lastSkyboxData)
            end
        end
    end
})

UtilitySection:AddToggle({
    text = "Custom Skybox",
    state = false,
    flag = "CustomSkybox",
    callback = function(state)
        customSkyboxEnabled = state
        if state then
            if lastSkyboxData then
                applySkybox(lastSkyboxData)
            else
                notify("No skybox ID(s) selected!", 4)
            end
        else
            restoreDefaultSkybox()
        end
    end
})




UtilitySection:AddButton({
    enabled = true,
    text = "Restore Original Settings",
    tooltip = "Reset all lighting to original values",
    callback = function()
        restoreOriginalLighting()
        
        -- Reset all effects
        if _G.World.ColorCorrection then
            _G.World.ColorCorrection.Enabled = false
        end
        if _G.World.Blur then
            _G.World.Blur.Enabled = false
        end
        if _G.World.DepthOfField then
            _G.World.DepthOfField.Enabled = false
        end
        if _G.World.SunRays then
            _G.World.SunRays.Enabled = false
        end
        if _G.World.Bloom then
            _G.World.Bloom.Enabled = false
        end
        
        -- Disable stretch
        disableHorizontalStretch()
        
        _G.CROW:SendNotification("Original settings restored", 3)
    end
})

UtilitySection:AddButton({
    enabled = true,
    text = "Remove All Effects",
    tooltip = "Remove all CROW lighting effects",
    callback = function()
        if _G.World.ColorCorrection then
            _G.World.ColorCorrection:Destroy()
            _G.World.ColorCorrection = nil
        end
        if _G.World.Blur then
            _G.World.Blur:Destroy()
            _G.World.Blur = nil
        end
        if _G.World.DepthOfField then
            _G.World.DepthOfField:Destroy()
            _G.World.DepthOfField = nil
        end
        if _G.World.SunRays then
            _G.World.SunRays:Destroy()
            _G.World.SunRays = nil
        end
        if _G.World.Bloom then
            _G.World.Bloom:Destroy()
            _G.World.Bloom = nil
        end
        
        _G.CROW:SendNotification("All effects removed", 3)
    end
})



-- Cleanup function
_G.World.Cleanup = function()
    restoreOriginalLighting()
    
    -- Restore GUI elements and FOV
    toggleWidescreen(false)
    restoreOriginalFOV()
    
    if _G.World.ColorCorrection then
        _G.World.ColorCorrection:Destroy()
        _G.World.ColorCorrection = nil
    end
    if _G.World.Blur then
        _G.World.Blur:Destroy()
        _G.World.Blur = nil
    end
    if _G.World.DepthOfField then
        _G.World.DepthOfField:Destroy()
        _G.World.DepthOfField = nil
    end
    if _G.World.SunRays then
        _G.World.SunRays:Destroy()
        _G.World.SunRays = nil
    end
    if _G.World.Bloom then
        _G.World.Bloom:Destroy()
        _G.World.Bloom = nil
    end
    
    _G.CROW:SendNotification("World section cleaned up", 2)
end
